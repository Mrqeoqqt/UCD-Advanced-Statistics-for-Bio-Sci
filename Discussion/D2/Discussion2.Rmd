---
title: "Discussion2"
author: "Shitong Wei"
date: "4/13/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,eval=TRUE)
```
First load the data into R.

```{r}
setwd("~/Desktop/Spring Quarter 2018/STA101/Discussion2")
data <- read.csv("drivers.csv")
```

Import the package that we want to use

```{r}
library(ggplot2)
```

##Problem 1
**(a)**
Scatterplot using standard plot in R.

```{r}
plot(data$Age,data$Distance, main = "Age vs. Distance",
     xlab = "Age in year",ylab = "Distance in feet", 
     pch = 19)
```

Use ggplot package

```{r}
qplot(Age,Distance,data=data) + ggtitle("Age vs. Distance")+
  xlab("Age in year") + ylab("Distance in feet")
```

The scatterplot suggests a negative trend between distance and age.

To calculate mean, we use *mean()*. To calculate standard deviation, we use *sd()*. To make the result look better, we can use a matrix in R.

*c()* helps us to construct a column.

```{r}
summary.stats = round(c(mean(data$Age),mean(data$Distance),
                        sd(data$Age),sd(data$Distance)),4)
```

*matrix()* allows us to construct a matrix. What does *byrow* do? We need to be careful about the order of filling a matrix.

```{r}
nice.table = matrix(summary.stats,nrow = 2, byrow = TRUE)
```

Recall last time we use *colnames()* to extract the names of the variables in a dataframe. We can also use it to name columns. Similarly, there is *rownames()* for rows.

```{r}
colnames(nice.table) = c("Age","Distance")
rownames(nice.table) = c("mean","std.dev")
nice.table
```

**(b)**

Regression model in R.

```{r}
model = lm(Distance ~ Age, data)
```

The estimated coefficients of the model is the intercept and the slope for the estimated regression line respectively.

```{r}
round(model$coefficients,4)
```

We use *name()* to get or set the names of an object.

```{r}
names(model)
```

The estimated correlation coefficient is 

```{r}
round(cor(data$Age,data$Distance),3)
```

**(c)**

There are two ways to calculate the predicted value. One way is to calculate using the estimated regression line.

```{r}
round(29*model$coef[2]+model$coef[1],4)
```

The other way is to use the *predict()* function, the regression model object and a new data frame.

```{r}
new.data = data.frame(Age = 29)
predict(model,new.data)
```

**(d)**

The estimated value

```{r}
new.data2 = data.frame(Age = 18)
yhat = predict(model,new.data2)
```

The observed value

```{r}
y = data$Distance[which(data$Age==18)]
```

The error is 

```{r}
y - yhat
```

It is negative, so we overestimate.

**(e)**

Interpretation of the slope: When age increases by one year, we expect the distance a driver can see to decrease by -3.0068 feet on average.

Interpretation of the intercept: Since the range of our data does not cover 0, and also humans are not driving at age 0, there is no practical interpretation for the intercept.






