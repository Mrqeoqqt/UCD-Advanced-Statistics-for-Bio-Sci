---
title: "STA101 Discussion 1"
author: "Shitong Wei"
date: "4/7/2018"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,eval=TRUE)
```

First set the working directory to the directory where the data file is.

```{r}
setwd("~/Desktop/Spring Quarter 2018/STA101")
```

Then load the data into R.

```{r}
data <- read.csv("patients101.csv",header=T)
```
where *header = T* is a default option, and proper for this data set. Try *header = F* to see what happens.

Here we need package *ggplot2*. If a package is not installed on the computer, we need to install it first with *install.packages('package name')*. Installation is only needed for the first time on a computer. Packages need to be imported before using. 

```{r}
library('ggplot2')
```

## Problem 1

### a

(4.1.1 in R Handout - Summary Statistics and Plots)

Create a histogram in standard R.

```{r}
hist(data$sysBP,xlab = "Systolic Blood Pressure",main="Distribution of Systolic Blood
     Pressure 1(a)",breaks=20)
```

Create a histogram with ggplot2. 

```{r}
ggplot(data,aes(x=sysBP))+geom_histogram(binwidth=5,color="black",fill="white")+
  xlab("Systolic Blood Pressure")+ggtitle("1(a): Distribution of systolic blood pressure")
```

Note the difference of labelling axes and making a main title in standard R and ggplot2.

A small trick here to separate code in .R file.

```{r}
########## part 1a ########
```

Forget the names of the variables? Try

```{r}
colnames(data)
```

### b

It is slightly right skewed. There is a long right tail.

### c

(4.1.2 in R Handout - Summary Statistics and Plots)

A boxplot in standard R.

```{r}
boxplot(data$sysBP, horizontal = TRUE,main = "Distribution of Systolic Blood Pressure 1(c)")
```

A boxplot in ggplot2.

```{r}
ggplot(data, aes(y=sysBP, x = factor("")))+ geom_boxplot()+ylab("Systolic Blood Pressure")+
  xlab(" ")+coord_flip()+ggtitle("1(c): Distribution of systolic blood pressure")
```

Try without *coord_flip()* to see what this function does. 

Use *?function_name* or *??function_name* to get information about a function. Note the difference between *?* and *??*.


### d
* There are six unusually large data points. 
* Why there are no points on the left hand side? 
* What do the lines mean in the boxplot?

## Problem 2

### a

(4.3.1 in R Handout - Summary Statistics and Plots)

Scatter plot in standard R.

```{r}
plot(data$weight, data$sysBP, main = "2(a):Relationship between Systolic Blood
     Pressure and Weight",xlab = "Weight in pounds",ylab = "Systolic BP",pch = 19)
```


Scatter plot in ggplot2.

```{r}
qplot(weight, sysBP, data = data) + ggtitle("2(a):Relationship between Systolic Blood
     Pressure and Weight") + xlab("Weight in pounds") + ylab("Systolic BP")
```

Which variable appears on the x-axis and which appears on the y-axis?

### b
There seems a slight positive trend.

### c

(4.3.1 in R Handout - Summary Statistics and Plots)

Standard R.

```{r}
plot(data$sedmins, data$sysBP, main = "2(c):Relationship between Systolic
     Blood Pressure and Sedentary Minutes",xlab = "Sedentary Minutes",ylab = "Systolic BP",pch = 19)
```

ggplot2.

```{r}
qplot(sedmins, sysBP, data = data) + ggtitle("2(a):Relationship between Systolic Blood
     Pressure and Sedentary Minutes") + xlab("Sedentary Minutes") + ylab("Systolic BP")
```


### d

No obvious trend in the scatter plot.

## Problem 3

### a

(4.5 in R Handout - Summary Statistics and Plots)

Standard R.

```{r}
boxplot(sysBP ~ gender, data = data, main = "Blood Pressure by Gender",horizontal = TRUE)
```

ggplot2.

```{r}
ggplot(data,aes(y = sysBP,x =gender)) + geom_boxplot() + ylab("Systolic Blood Pressure") +
  xlab("Gender") + ggtitle("Blood Pressure by Gender") + coord_flip()
```

Compare with Problem 1c. Which part makes a groupd boxplot?

### b

There is no significant difference. Due to randomness, the boxplots will not overlap completely even if there is no difference between the two groups.

### c

(4.5.1 in R Handout - Summary Statistics and Plots)

ggplot2.

```{r}
ggplot(data, aes(x = sysBP)) + geom_histogram(binwidth = 2,color = "black",fill = "white")+
  facet_grid(obese~.)+ggtitle("Systolic Blood Pressure by Obesity Cateogory")
```

Compare with Problem 1a to see what makes the grouped histogram. Use *?* to look up *facet_grid()*. Try other different variables other than *obese* to see what we can get.


## Problem 4

### a

(1.1.1 in R Handout - Summary Statistics and Plots)

```{r}
round(mean(data$sysBP),4)
```

What does *round()* do? Try *mean(data$sysBP)*.

What about *round(mean(data$sysBP),1)*?

### b

(2.1 in R Handout - Summary Statistics and Plots)

```{r}
aggregate(sysBP ~ marriage, data = data, mean)
```

### c

(2.2 in R Handout - Summary Statistics and Plots)

```{r}
aggregate(sysBP ~ marriage, data = data, sd)
```

Difference from last question?

### d

(2.3 in R Handout - Summary Statistics and Plots)

```{r}
aggregate(sysBP ~ marriage, data = data, sd)
```

Difference from last two questions?

### e

(1.3 in R Handout - Summary Statistics and Plots)

```{r}
fivenum(data$weight)
```

What is five number summary? Try to look up *fivenum()*.
